# 更新日志

## v4.1.8

- 功能优化：**UI 全新改版，支持主题切换**。 :rocket: :rocket: :rocket:
- 功能新增：Gitee AI API 接口接入，目前支持 Gitee 的 SD 绘图接口，支持 Gitee 的 AI 对话接口。:rocket: :rocket: :rocket:
- Bug 修复：修复音 Luma API 更新导致任务响应解析失败的错误
- 功能优化：支持 Suno v4.0 模型支持
- Bug 修复：修复 Suno 已完成任务删除失败的 错误
- 功能新增：支持 OpenAI 实时语音通话功能，目前已经支持按次收费，支持管理员设置每次实时语音通话的算力消耗
- 功能新增：生成提示词需要消耗算力，支持管理员设置每次生成提示词的算力消耗，防止被白嫖
- 功能新增：DALL-E-3 绘图支持 Flux 绘图模型，支持在管理后添加 Flux,SD 等绘图模型
- 功能优化：Markdown 支持解析 emoji 表情
- 功能优化：当管理后台禁用了某个绘图菜单的时候，移动端绘图菜单也会同步禁用（不显示该功能）

## v4.1.7

- Bug 修复：手机邮箱相关的注册问题 [#IB0HS5](https://gitee.com/blackfox/geekai/issues/IB0HS5)
- Bug 修复：音乐视频无法下载，思维导图下载后看不清文字[#IB0N2E](https://gitee.com/blackfox/geekai/issues/IB0N2E)
- 功能优化：保存所有 AIGC 任务的原始信息，程序启动之后自动将未执行的任务加入到 redis 队列
- 功能优化：失败的任务自动退回算力，而不需要在删除的时候再退回
- 功能新增：支持设置一个专门的模型来翻译提示词，提供 Mate 提示词生成功能
- Bug 修复：修复图片对话的时候，上下文不起作用的 Bug
- 功能新增：管理后台新增批量导出兑换码功能

## v4.1.6

- 功能新增：**支持 OpenAI 实时语音对话功能** :rocket: :rocket: :rocket:, Beta 版，目前没有做算力计费控制，目前只有 VIP 用户可以使用。
- 功能优化：优化 MysQL 容器配置文档，解决 MysQL 容器资源占用过高问题
- 功能新增：管理后台增加 AI 绘图任务管理，可在管理后台浏览和删除用户的绘图任务
- 功能新增：管理后台增加 Suno 和 Luma 任务管理功能
- Bug 修复：修复管理后台删除兑换码报 404 错误
- 功能优化：优化充值产品定价逻辑，可以设置原价和优惠价，**升级当前版本之后请务必要到管理后台去重新设置一下产品价格，以免造成损失！！！**，**升级当前版本之后请务必要到管理后台去重新设置一下产品价格，以免造成损失！！！**，**升级当前版本之后请务必要到管理后台去重新设置一下产品价格，以免造成损失！！！**。

## v4.1.5

- 功能优化：重构 websocket 组件，减少 websocket 连接数，全站共享一个 websocket 连接
- Bug 修复：兼容手机端原生微信支付和支付宝支付渠道
- Bug 修复：修复删除绘图任务时候因为字段长度过短导致 SQL 执行失败问题
- 功能优化：优化 Vue 组件通信代码，使用共享数据来替换之前的事件订阅模式，效率更高一些
- 功能优化：优化思维导图生成功果页面，优化用户体验

## v4.1.4

- 功能优化：用户文件列表组件增加分页功能支持
- Bug 修复：修复用户注册失败 Bug，注册操作只弹出一次行为验证码
- 功能优化：首次登录不需要验证码，直接登录，登录失败之后才弹出验证码
- 功能新增：给 AI 应用（角色）增加分类，前端支持分类筛选
- 功能优化：允许用户在聊天页面设置是否使用流式输出或者一次性输出，兼容 GPT-O1 模型。
- 功能优化：移除 PayJS 支付渠道支持，PayJs 已经关闭注册服务，请使用其他支付方式。
- 功能新增：新增 GeeK 易支付支付渠道，支持支付宝，微信支付，QQ 钱包，京东支付，抖音支付，Paypal 支付等支付方式
- Bug 修复：修复注册页面 tab 组件没有自动选中问题 [#6](https://github.com/yangjian102621/geekai-plus/issues/6)
- 功能优化：Luma 生成视频任务增加自动翻译功能
- Bug 修复：Suno 和 Luma 任务没有判断用户算力
- 功能新增：邮箱注册增加邮箱后缀白名单，防止使用某些垃圾邮箱注册薅羊毛
- 功能优化：清空未支付订单时，只清空超过 15 分钟未支付的订单

## v4.1.3

- 功能优化：重构用户登录模块，给所有的登录组件增加行为验证码功能，支持用户绑定手机，邮箱和微信
- 功能优化：重构找回密码模块，支持通过手机或者邮箱找回密码
- 功能优化：管理后台给可以拖动排序的组件添加拖动图标
- 功能优化：Suno 支持合成完整歌曲，和上传自己的音乐作品进行二次创作
- Bug 修复：手机端角色和模型选择不生效
- Bug 修复：用户登录过期之后聊天页面出现大量报错，需要刷新页面才能正常
- 功能优化：优化聊天页面 Websocket 断线重连代码，提高用户体验
- 功能优化：给算力增减服务全部加上数据库事务和同步锁
- 功能优化：支持用户在前端对话界面选择插件
- 功能新增：支持 Luma 文生视频功能

## v4.1.2

- Bug 修复：修复思维导图页面获取模型失败的问题
- 功能优化：优化 MJ,SD,DALL-E 任务列表页面，显示失败任务的错误信息，删除失败任务可以恢复扣减算力
- Bug 修复：修复后台拖动排序组件 Bug
- 功能优化：更新数据库失败时候显示具体的的报错信息
- Bug 修复：修复管理后台对话详情页内容显示异常问题
- 功能优化：管理后台新增清空所有未支付订单的功能
- 功能优化：给会话信息和系统配置数据加上缓存功能，减少 http 请求
- 功能新增：移除微信机器人收款功能，增加卡密功能，支持用户使用卡密兑换算力

## v4.1.1
* Bug修复：修复 GPT 模型 function call 调用后没有输出的问题
* 功能新增：允许获取 License 授权用户可以自定义版权信息
* 功能新增：聊天对话框支持粘贴剪切板内容来上传截图和文件
* 功能优化：增加 session 和系统配置缓存，确保每个页面只进行一次 session 和 get system config 请求
* 功能优化：在应用列表页面，无需先添加模型到用户工作区，可以直接使用
* 功能新增：MJ 绘图失败的任务不会自动删除，而是会在列表页显示失败详细错误信息
* 功能新增：允许在设置首页纯色背景，背景图片，随机背景图片三种背景模式
* 功能新增：允许在管理后台设置首页显示的导航菜单
* Bug修复：修复注册页面先显示关闭注册组件，然后再显示注册组件
* 功能新增：增加 Suno 文生歌曲功能
* 功能优化：移除多平台模型支持，统一使用 one-api 接口形式，其他平台的模型需要通过 one-api 接口添加
* 功能优化：在所有列表页面增加返回顶部按钮

## v4.1.0
* bug修复：修复移动端修改聊天标题不生效的问题
* Bug修复：修复用户注册不显示用户名的问题
* Bug修复：修复管理后台拖动排序不生效的问题
* 功能优化：允许用户设置自定义首页背景图片
* 功能新增：**支持AI解读 PDF, Word, Excel等文件**
* 功能优化：优化聊天界面的用户上传文件的列表样式
* 功能优化：优化聊天页面对话样式，支持列表样式和对话样式切换
* 功能新增：支持微信扫码登录，未注册用户微信扫码后会自动注册并登录。移动使用微信浏览器打开可以实现无感登录。


## v4.0.9
* 环境升级：升级 Golang 到 go1.22.4
* 功能增加：接入微信商户号支付渠道
* Bug修复：修复前端页面菜单把页面撑开，底部留白问题
* 功能优化：聊天页面自动根据内容调整输入框的高度
* Bug修复：修复Dalle绘图失败退回算力的问题
* 功能优化：邀请码注册时被邀请人也可以获得赠送的算力
* 功能优化：允许设置邮件验证码的抬头
* Bug修复：修复免费模型不会记录聊天记录的bug
* Bug修复：修复聊天输入公式显示异常的Bug

## v4.0.8
* 功能优化：升级 mathjax 公式解析插件，修复公式因为图片访问限制而无法显示的问题
* 功能优化：当数据库更新失败的时候记录错误日志
* 功能优化：聊天输入框会随着输入内容的增多自动调整高度
* Bug修复：修复移动端聊天页面模型切换不生效的Bug
* 功能优化：给PC端扫码支付增加签名验证和有效期验证
* Bug修复：修复支付码生成API权限控制的问题
* Bug修复：模型算力设置为0时，不扣减用户算力，并且不记录算力消费日志
* 功能优化：新增随机背景配置项，可以在后台设置，首页使用 Bing 壁纸作为背景图片
* 功能新增：H5端支持 Dalle 绘图

## v4.0.7

* 功能优化：添加导航菜单的时候支持框入外部链接，并支持上传自定义菜单图片
* Bug修复：修复弹窗等于图形验证码一直验证失败的问题
* 功能重构：重构前端 UI 页面，增加顶部导航
* 功能优化：优化 Vue 非父子组件之间的通信方式
* 功能优化：优化 ItemList 组件，自动根据页面宽度计算 cols 数量

## v4.0.6

* Bug修复：修复PC端画廊页面的瀑布流组件样式错乱问题
* 功能新增：给思维导图增加 ToolBar，实现思维导图的放大缩小和定位
* Bug修复：修复思维导图不扣费的Bug
* Bug修复：修复管理后台角色删除失败的Bug
* Bug修复：兼容最新版秋叶SD懒人包的 SD API，新增 scheduler 参数
* 功能优化：支持在管理后台配置 AI 绘图相关配置，包括 SD, MJ-PLUS, MJ-PROXY
* Bug修复：修复注册用户提示注册人数达到上限的 Bug
* 功能优化：将MJ,SD,Dall绘画页面的任务列表全改成瀑布流组件


## v4.0.5

* 功能优化：已授权系统在后台显示授权信息
* 功能优化：使用思维链提示词生成思维导图，确保生成的思维导图不会出现格式错误
* 功能优化：优化首页登录注册页面的 UI
* BUG修复：修复License验证的逻辑漏洞
* Bug修复：后台添加用户的时候密码规则限制跟前台注册保持一致
* 功能新增：管理后台支持切换主题，支持 light 和 dark 两种主题
* 功能新增：移动端新增 DALL-E 绘画功能
* 功能新增：新增移动端首页功能，移动端支持 light 和 dark 两种主题
* 功能新增：移动支持免登录预览功能
* Bug修复：解决在同一个浏览器开启多个对话时候对话内容会相互乱串的问题
* Bug修复：修复部分中转 API 模型会出现第一输出的字符被淹没的Bug

## v4.0.4

* Bug修复：修复统一千问第二句不回复的问题
* 功能优化：MJ 和 SD 任务正在执行时不更新已完成任务列表，加快页面渲染速度
* 功能新增：Dalle AI 绘画功能实现
* Bug修复：修复思维导图格式乱码问题
* 功能优化：支持使用 TLS 邮件协议，解决国内服务器无法使用 25 号端口发送邮件的问题
* 功能新增：支持从应用列表直接和某个应用对话
* 功能优化：优化算力日志的页面和首页的UI
* 功能新增：支持思维导图导出 PNG 图片下载